# Books.json 更新逻辑

## 概述

`scripts/convert_books.py` 脚本用于从 Excel 文件更新 `data/books.json`，采用**增量更新**策略，不会删除或覆盖现有数据。

## 更新逻辑

### 1. 读取现有数据
- 读取 `data/books.json` 中的所有书籍
- 创建 ID → 书籍的映射

### 2. 处理 Excel 数据
对于 Excel 中的每一本书：
- **如果 ID 匹配现有书籍**：
  - ✅ 只更新新字段：`coverImage`、`curatorNote`
  - ✅ 保留所有原有字段和数据
- **如果是新书籍**（ID 不存在）：
  - ➕ 添加完整的书籍信息

### 3. 保留不在 Excel 中的书
- Excel 里没有的书籍会被**完整保留**
- 不会删除任何现有数据

## 使用方法

```bash
python3 scripts/convert_books.py
```

## 输出示例

```
📖 正在读取 Excel 文件...
✓ 成功读取 54 本书籍
✓ 成功读取 54 本现有书籍

🔄 正在转换并更新书籍...
✓ 新增书籍: 0 本
✓ 更新书籍: 54 本
✓ 保留书籍: 0 本
✓ 总计: 54 本
```

## 测试验证

✅ **已验证**：
- 更新现有书籍时保留自定义字段
- Excel 里没有的书被完整保留
- 新书正确添加
- Next.js 构建成功

## 数据安全

- **不会删除**任何现有书籍
- **不会覆盖**现有字段（除了明确要更新的字段）
- **保留**所有自定义添加的数据

## 备份

脚本运行时会自动创建备份：
```bash
cp data/books.json data/books.json.backup
```

如有问题，可从备份恢复。
